<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tablero Interactivo</title>
  <style>
    body {
      background: #111;
      color: #eee;
      font-family: sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }

    #reset {
      margin-bottom: 10px;
      padding: 8px 16px;
      font-size: 16px;
      cursor: pointer;
    }

    .startCell {
      width: 110px;
      height: 110px;
      border: 2px dashed #999;
      background: #fff;
      border-radius: 10px;
      position: relative;
      margin-bottom: 20px;
    }

    .piece {
      width: 94px;
      height: 94px;
      top: 8px;
      left: 8px;
      background-size: cover;
      background-position: center;
      border-radius: 50%;
      position: absolute;
      touch-action: none;
      cursor: grab;
      z-index: 10;
      border: 2px solid #333;
    }

    #board {
      display: grid;
      grid-template-columns: repeat(10, 94px);
      grid-template-rows: repeat(4, 94px);
      gap: 4px;
      padding: 10px;
      background: #222;
      border-radius: 10px;
    }

    .cell {
      width: 94px;
      height: 94px;
      border: 1px solid #aaa;
      position: relative;
    }

    .extra {
      width: 94px;
      height: 94px;
      background: #000;
      border: 2px solid #000;
      position: absolute;
      z-index: 5;
    }
  </style>
</head>
<body>
  <button id="reset">ðŸ”„ Reiniciar</button>
  <div class="startCell" id="startZone"></div>
  <div id="board"></div>

  <script>
    const board = document.getElementById("board");
    const resetBtn = document.getElementById("reset");
    const startZone = document.getElementById("startZone");

    function createBoard() {
      board.innerHTML = "";
      for (let i = 0; i < 40; i++) {
        const cell = document.createElement("div");
        cell.className = "cell";
        cell.dataset.index = i;
        board.appendChild(cell);
      }
    }

    function createPiece(id, color) {
      const piece = document.createElement("div");
      piece.className = "piece";
      piece.style.background = color;
      piece.id = id;
      piece.draggable = true;

      piece.addEventListener("dragstart", (e) => {
        e.dataTransfer.setData("text/plain", id);
      });

      return piece;
    }

    function enableDropZones() {
      document.querySelectorAll(".cell, .startCell").forEach((zone) => {
        zone.addEventListener("dragover", (e) => e.preventDefault());
        zone.addEventListener("drop", (e) => {
          e.preventDefault();
          const id = e.dataTransfer.getData("text/plain");
          const piece = document.getElementById(id);
          zone.appendChild(piece);
          localStorage.setItem(id, zone.dataset.index || "start");
        });
      });
    }

    function loadMemory(id) {
      const saved = localStorage.getItem(id);
      if (saved === "start") {
        startZone.appendChild(document.getElementById(id));
      } else {
        const target = document.querySelector(`[data-index='${saved}']`);
        if (target) target.appendChild(document.getElementById(id));
      }
    }

    function resetBoard() {
      localStorage.clear();
      startZone.appendChild(document.getElementById("p1"));
      startZone.appendChild(document.getElementById("p2"));
    }

    createBoard();
    const p1 = createPiece("p1", "tomato");
    const p2 = createPiece("p2", "deepskyblue");
    startZone.appendChild(p1);
    startZone.appendChild(p2);
    enableDropZones();
    loadMemory("p1");
    loadMemory("p2");
    resetBtn.addEventListener("click", resetBoard);
  </script>
</body>
</html>
